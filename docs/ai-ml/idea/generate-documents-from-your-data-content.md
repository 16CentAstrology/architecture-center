[!INCLUDE [header_file](../../../includes/sol-idea-header.md)]

This architecture demonstrates a document generation solution that enables organizations to create intelligent structured and unstructured documents grounded in their enterprise data. The solution uses Azure AI services and Azure AI Search to identify relevant data, summarize information, and generate contextual content through conversational interactions. Users can generate documents based on this organizational knowledge and receive them in Microsoft Word format, with results cached for efficient reuse.

This architecture shows how to build a comprehensive system for generating business documents using AI. It combines retrieval, summarization, and generation with document persistence to support faster document creation workflows. The system enables user interaction through natural language and helps embed organizational knowledge directly into document processing workflows, while caching generated content to avoid regeneration overhead.

## Architecture

:::image type="complex" border="false" source="./_images/generate-documents-from-your-data.png" alt-text="Diagram that shows a document generation solution architecture using Azure AI services." lightbox="./_images/generate-documents-from-your-data.png":::
   Document generation architecture showing the flow from sample data through Azure services to the web frontend for form-based template generation and export.
:::image-end:::

*Download a [Visio file](https://arch-center.azureedge.net/generate-documents-from-your-data.vsdx) of this architecture.*

### Workflow

The following workflow corresponds to the preceding diagram:

1. Enterprise documents and reference materials serve as foundational knowledge for document generation is generated by line of business applications or other processes in the organization.

2. A synchronization process periodically manages the ingestion and updating of enterprise data from various sources into this workload.

3. Azure Storage Account receives and stores enterprise documents (including PDF files), making them available for processing and indexing by downstream services. A storage account will also be used to store the generated documents from user sessions.

4. Azure AI Services (specifically Azure Document Intelligence) processes PDFs and other documents, performing enrichment and vectorization to prepare content for indexing.

5. Azure AI Search creates searchable indexes from the processed and enriched documents, enabling semantic search capabilities and rapid information retrieval for document generation. Indexing skills could be used for maintaining the index in AI Search.

6. Azure OpenAI Service utilizes the indexed content to power conversational interactions through Chat Completion, Conversation Loop, and JSON Mode via SDK, generating contextual documents based on user queries and organizational data.

7. App Service hosts the web frontend where users interact with the system through natural language to interact with the document generation system.

8. Azure Cosmos DB stores conversation history and user interactions, while maintaining context for continuous improvement.

### Components

- [Azure App Service](/azure/well-architected/service-guides/app-service-web-apps) is a platform as a service (PaaS) solution that provides a scalable web hosting environment for applications. In this architecture, App Service hosts the web frontend interface where users interact with their enterprise data through conversational AI functionality. The interface enables both structured and unstructured document generation and DOCX export capabilities, providing a responsive and intuitive user experience.

- [Azure OpenAI Service](/azure/well-architected/service-guides/azure-openai) is a managed AI service that provides access to advanced language models for natural language processing and generation. In this architecture, Azure OpenAI Service powers the conversational interface and document generation capabilities, utilizing GPT models through Chat Completion, Conversation Loop, and JSON Mode via SDK to understand user queries, synthesize content from enterprise data, and generate contextual documents ranging from structured forms to unstructured business content.

- [Azure AI Search](/azure/search/search-what-is-azure-search) is a cloud search service that provides rich search capabilities over diverse content types. In this architecture, Azure AI Search enables retrieval-augmented generation (RAG) by creating semantic search indexes of enterprise documents, allowing the system to quickly identify and retrieve relevant information for contextual document generation and locate previously cached documents.

- [Azure AI Services](/azure/ai-services/) provides a collection of AI services for processing and understanding various types of content. In this architecture, Azure AI Services processes enterprise documents through Azure Document Intelligence to extract text, understand structure, and perform enrichment and vectorization to prepare content for indexing and generation workflows, supporting both structured and unstructured document creation.

- [Azure Storage Account](/azure/well-architected/service-guides/azure-blob-storage) is Microsoft's object storage solution optimized for storing massive amounts of unstructured data. In this architecture, Azure Storage Account stores enterprise documents and reference materials (including PDF files) that provide the foundational knowledge base for the document generation process. It is also used to store generated documents for caching purposes.

- [Azure Cosmos DB](/azure/well-architected/service-guides/cosmos-db) is a globally distributed, multi-model database service that provides guaranteed low latency and elastic scalability. In this architecture, Cosmos DB stores conversation history and user interactions. This maintains context across sessions, enables intelligent document retrieval, and eliminates regeneration overhead for improved performance.


## Scenario details

This document generation solution addresses the challenge organizations face when creating consistent, high-quality business documents that leverage institutional knowledge. Traditional document creation often suffers from blank page syndrome, inconsistent formatting, missed relevant information, and significant time investment from subject matter experts. The solution transforms document creation through conversational AI that generates both structured forms (like contracts, invoices, promissory notes) and unstructured documents (like proposals, reports, briefings) grounded in organizational data.

This architecture supports transactional usage only, with batch processing not supported, ensuring focused, real-time document generation workflows that maintain quality and consistency for individual document requests. Generated documents are available for local download only and are not cached anywhere within the system, ensuring data privacy and security while requiring users to manage their own document storage and version control locally.

### Potential use cases

### Legal and compliance documentation

**Contract template generation**: Auto-generate contract templates that are based on previous agreements, legal precedents, and company policies. This ensures consistency and compliance across all business relationships.

**Regulatory submission preparation**: Create compliance documentation by synthesizing relevant regulations, organizational policies, and historical submission data into properly formatted regulatory filings.

**Legal brief drafting**: Generate legal document drafts by analyzing case law, precedents, and client information stored in the organization's knowledge base.

### Business operations and proposals

**Investment proposal creation**: Synthesize market research, financial data, and strategic documents to generate comprehensive investment proposals tailored to specific opportunities and stakeholder requirements.

**Grant application development**: Create grant applications by combining project requirements, organizational capabilities, and historical successful submissions into compelling funding requests.

**RFP response generation**: Automatically draft responses to requests for proposals by analyzing requirements against organizational capabilities and previous successful proposals.

### Financial and procurement documentation

**Invoice template standardization**: Generate consistent invoice templates that incorporate organizational branding, legal requirements, and customer-specific terms based on historical billing data.

**Purchase order automation**: Create purchase orders by referencing vendor databases, procurement policies, and budget constraints to ensure compliance and accuracy.

**Financial report compilation**: Generate financial reports by synthesizing data from multiple sources into standardized templates that meet regulatory and stakeholder requirements.

### Healthcare and research applications

**Clinical protocol documentation**: Generate research protocols by combining regulatory requirements, institutional guidelines, and previous study designs into compliant and comprehensive documents.

**Patient care plan templates**: Create standardized care plan templates that incorporate best practices, institutional policies, and patient-specific considerations.

**Research grant proposals**: Develop research funding proposals by synthesizing scientific literature, institutional capabilities, and funding agency requirements.

## Alternatives

This architecture includes multiple components that you can substitute with other Azure services or approaches, depending on your workload's functional and nonfunctional requirements. Consider the following alternatives and trade-offs.

### Document generation approach

**Current approach:** Custom AI-powered generation with enterprise data grounding and intelligent caching for both structured and unstructured documents.

**Alternative approach:** Use Azure AI Foundry's Document Intelligence with pre-built forms for structured documents only, combined with traditional document management systems.

Consider the alternative if your workload primarily focuses on standardized forms with minimal unstructured content requirements.

### Caching Strategy

**Current approach:** Cosmos DB for document caching with semantic search integration for intelligent retrieval.

**Alternative approach:** Traditional file storage with metadata indexing or hybrid approach combining blob storage for document files with database metadata.

Consider alternatives based on document size, retrieval patterns, and integration requirements with the conversational interface.

## Cost Optimization

Cost Optimization is about reducing unnecessary expenses and improving operational efficiencies. For more information, see [Design review checklist for Cost Optimization](/azure/well-architected/cost-optimization/checklist).

For information about the costs of running this scenario, see this preconfigured [estimate in the Azure pricing calculator](https://azure.com/e/82efdb5321cc4c58aafa84607f68c24a).

Pricing varies per region and usage, so it isn't possible to predict exact costs for your usage. The majority of the Azure resources used in this infrastructure are on usage-based pricing tiers. However, Azure Container Registry has a fixed cost per registry per day.

## Deploy this scenario

To deploy an implementation of this architecture, follow the steps in the [GitHub repository](https://github.com/microsoft/document-generation-solution-accelerator).

## Next Steps

- [Azure AI Search documentation](/azure/search/)
- [Design and develop a RAG solution](/azure/architecture/ai-ml/guide/rag/rag-solution-design-and-evaluation-guide)